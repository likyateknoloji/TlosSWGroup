<?xml version="1.0" encoding="UTF-8"?>

<ui:composition template="/templates/common/commonLayout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:param name="title"
		value="Tlos SW Workload Automation Software v1.0 - Agent Definition Page" />

	<ui:define name="center">

		<ui:param name="title1" value="Main Menu" />
		<ui:param name="title2" value="Definitions" />
		<ui:param name="title3" value="Advanced D." />
		<ui:param name="title4" value="Agents" />
		<ui:param name="title5" value="" />

		<ui:param name="title1link" value="/" />
		<ui:param name="title2link" value="agentPanel.xhtml" />
		<ui:param name="title3link" value="agentPanel.xhtml" />
		<ui:param name="title4link"
			value="/inc/definitionPanels/advancedDefinitions/agentPanel.xhtml" />
		<ui:param name="title5link"
			value="Tlos SW Workload Automation Software v1.0 - Agent Management Page" />
		<h:form>
			<p:breadCrumb>
				<p:menuitem value="#{title1}" url="#{title1link}" />
				<p:menuitem value="#{title2}" url="#{title2link}" />
				<p:menuitem value="#{title3}" url="#{title3link}" />
				<p:menuitem value="#{title4}" url="#{title4link}" />
			</p:breadCrumb>
		</h:form>

		<br></br>

		<h:form id="yeniKullaniciForm">
			<p:fieldset
				legend="#{msgs['tlos.management.pannel.agentProcesses.newAgentPanel']}"
				widgetVar="regWidget" style="width:65%;">

				<p:growl id="messages" showDetail="true" autoUpdate="true" />

				<p:panelGrid styleClass="companyHeaderGrid" columns="4" border="0"
					style="width:100%;">

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.resource']}" />
					<p:selectOneMenu value="#{agentPanelMBean.resource}"
						required="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.resource']}">
						<f:selectItem itemLabel="#{msgs['tlos.combo.select']}"
							itemValue="" />
						<f:selectItems value="#{agentPanelMBean.resourceList}" />
					</p:selectOneMenu>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.osType']}" />
					<p:selectOneMenu id="osType" required="true"
						value="#{agentPanelMBean.osType}"
						label="#{msgs['tlos.management.pannel.agentProcesses.osType']}"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.osType']}">
						<f:selectItem itemLabel="#{msgs['tlos.combo.select']}"
							itemValue="" />
						<f:selectItem itemLabel="Unix" itemValue="Unix" />
						<f:selectItem itemLabel="Windows" itemValue="Windows" />
					</p:selectOneMenu>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.agentType']}" />
					<p:selectOneMenu id="agentType" required="true"
						value="#{agentPanelMBean.agentType}"
						label="#{msgs['tlos.management.pannel.agentProcesses.agentType']}">
						<f:selectItem itemLabel="#{msgs['tlos.combo.select']}"
							itemValue="" />
						<f:selectItems value="#{agentPanelMBean.agentTypeList}" />
					</p:selectOneMenu>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.nrpePort']}" />
					<p:inputText id="nrpePort" value="#{agentPanelMBean.nrpePort}"
						required="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.nrpePort']}"
						validatorMessage="#{msgs['tlos.agentPanel.valMessage.nrpePort.regex']}">
						<f:validateRegex pattern="[1-9][0-9]{3}" />
					</p:inputText>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.jmxTlsPort']}" />
					<p:inputText id="jmxTlsPort" value="#{agentPanelMBean.jmxTlsPort}"
						required="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.jmxTlsPort']}"
						validatorMessage="#{msgs['tlos.agentPanel.valMessage.jmxTlsPort.regex']}">
						<f:validateRegex pattern="[1-9][0-9]{3}" />
					</p:inputText>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.jmxUser']}" />
					<p:inputText id="jmxUser" value="#{agentPanelMBean.agent.jmxUser}"
						required="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.jmxUser']}"
						validatorMessage="#{msgs['tlos.agentPanel.valMessage.jmxUser.regex']}">
						<f:validateRegex pattern="([0-9a-zA-Z])+" />
					</p:inputText>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.jmxPassword']}" />
					<p:password id="password"
						value="#{agentPanelMBean.agent.jmxPassword}" feedback="false"
						match="password2"
						validatorMessage="#{msgs['tlos.agentPanel.reqMessage.passwordMatch']}"
						label="#{msgs['tlos.management.pannel.agentProcesses.jmxPassword']}"
						required="true" redisplay="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.password']}">
						<f:validateLength minimum="4" maximum="8"></f:validateLength>
					</p:password>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.jmxPassword.repeat']}" />
					<p:password id="password2" value="#{agentPanelMBean.jmxPassword2}"
						feedback="false" redisplay="true"
						label="#{msgs['tlos.management.pannel.agentProcesses.jmxPassword.repeat']}"
						validatorMessage="#{msgs['tlos.agentPanel.valMessage.password']}">
						<f:validateLength minimum="4" maximum="8"></f:validateLength>
					</p:password>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.durationForUnavailability']}" />
					<p:inputText id="durationForUnavailability"
						value="#{agentPanelMBean.durationForUnavailability}"
						required="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.timeOut']}"
						label="#{msgs['tlos.management.pannel.agentProcesses.durationForUnavailability']}"
						validatorMessage="#{msgs['tlos.agentPanel.valMessage.timeOut']}">
						<f:validateDoubleRange minimum="1"></f:validateDoubleRange>
					</p:inputText>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.jobTransferFailureTime']}" />
					<p:inputText id="jobTransferFailureTime"
						value="#{agentPanelMBean.jobTransferFailureTime}" required="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.jobTransferFailureTime']}"
						label="#{msgs['tlos.management.pannel.agentProcesses.jobTransferFailureTime']}"
						validatorMessage="#{msgs['tlos.agentPanel.reqMessage.jtft.regex']}">
						<f:validateDoubleRange minimum="0"></f:validateDoubleRange>
					</p:inputText>

					<h:outputText
						value="#{msgs['tlos.management.pannel.agentProcesses.workspacePath']}" />
					<p:inputText id="workspacePath"
						value="#{agentPanelMBean.workspacePath}" style="width:250px;"
						required="true"
						requiredMessage="#{msgs['tlos.agentPanel.reqMessage.workspacePath']}"
						label="#{msgs['tlos.management.pannel.agentProcesses.workspacePath']}"
						validatorMessage="#{msgs['tlos.agentPanel.reqMessage.workspacePath.regex']}">
						<f:validateRegex
							pattern="([abcdefgABCDEFG]:[\\/])?([a-zA-Z/\\\.0-9_ \-])*" />
					</p:inputText>

				</p:panelGrid>

				<br />
				<h:outputText
					value="#{msgs['tlos.management.pannel.agentProcesses.agentParameters']}" />
				<p:separator />

				<p:panel id="parametersPanel">
					<p:panelGrid id="localParameters" columns="4">
						<h:outputText
							value="#{msgs['tlos.workspace.pannel.job.parameterName']}" />
						<p:inputText value="#{agentPanelMBean.paramName}">
							<p:ajax partialSubmit="true"></p:ajax>
						</p:inputText>

						<h:outputText
							value="#{msgs['tlos.workspace.pannel.job.parameterDesc']}" />
						<p:inputText value="#{agentPanelMBean.paramDesc}">
							<p:ajax partialSubmit="true"></p:ajax>
						</p:inputText>

						<h:outputText
							value="#{msgs['tlos.workspace.pannel.job.parameterType']}" />
						<p:selectOneMenu value="#{agentPanelMBean.paramType}">
							<f:selectItem itemLabel="#{msgs['tlos.combo.select']}"
								itemValue="" />
							<f:selectItem itemLabel="#{msgs['tlos.combo.integer']}"
								itemValue="1" />
							<f:selectItem itemLabel="#{msgs['tlos.combo.string']}"
								itemValue="2" />
							<f:selectItem itemLabel="#{msgs['tlos.combo.date']}"
								itemValue="3" />
							<f:selectItem itemLabel="#{msgs['tlos.combo.time']}"
								itemValue="4" />
							<f:selectItem itemLabel="#{msgs['tlos.combo.dateTime']}"
								itemValue="5" />
							<f:selectItem itemLabel="#{msgs['tlos.combo.xPath']}"
								itemValue="6" />
							<p:ajax update="localParameters"></p:ajax>
						</p:selectOneMenu>

						<h:outputText
							value="#{msgs['tlos.workspace.pannel.job.parameterPreValue']}" />
						<p:inputText value="#{agentPanelMBean.paramPreValue}"
							rendered="#{agentPanelMBean.paramType eq '2' or agentPanelMBean.paramType eq '6'}" />

						<p:inputText value="#{agentPanelMBean.paramPreValue}"
							rendered="#{agentPanelMBean.paramType eq '1'}" type="integer"
							validatorMessage="#{msgs['tlos.agentPanel.valMessage.intParam']}">
							<f:validateLongRange minimum="-2147483648" maximum="2147483647"></f:validateLongRange>
						</p:inputText>

						<p:panelGrid columns="2"
							rendered="#{agentPanelMBean.paramType eq '3' or agentPanelMBean.paramType eq '4' or agentPanelMBean.paramType eq '5'}">
							<p:calendar value="#{agentPanelMBean.paramPreValue}"
								rendered="#{agentPanelMBean.paramType eq '3' or agentPanelMBean.paramType eq '5'}"
								showOn="focus" required="true" navigator="true">
								<f:convertDateTime pattern="dd.MM.yyyy" />
							</p:calendar>

							<p:inputMask value="#{agentPanelMBean.paramPreValueTime}"
								mask="99:99:99"
								rendered="#{agentPanelMBean.paramType eq '4' or agentPanelMBean.paramType eq '5'}" />
						</p:panelGrid>

					</p:panelGrid>

					<br />

					<p:commandButton
						value="#{msgs['tlos.workspace.pannel.job.addToParameterList']}"
						rendered="#{!agentPanelMBean.renderUpdateParamButton}"
						action="#{agentPanelMBean.addInputParameter}"
						update=":yeniKullaniciForm:parametersPanel" />
					<p:commandButton value="#{msgs['tlos.button.update']}"
						rendered="#{agentPanelMBean.renderUpdateParamButton}"
						update=":yeniKullaniciForm:parametersPanel"
						action="#{agentPanelMBean.updateInputParameter}" />

					<br />
					<br />

					<p:dataTable var="item" rows="10" id="parameterDataTable"
						rendered="#{not empty agentPanelMBean.parameterList}"
						value="#{agentPanelMBean.parameterList}"
						binding="#{agentPanelMBean.parameterTable}" paginator="true"
						paginatorPosition="bottom"
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						rowsPerPageTemplate="5,10,15">

						<p:column>
							<p:commandButton value="#{msgs['tlos.button.update']}"
								actionListener="#{agentPanelMBean['editInputParamAction']}">
							</p:commandButton>

							<p:commandButton value="#{msgs['tlos.button.delete']}"
								onclick="confirmation.show()" />
							<p:confirmDialog id="confirmDialog"
								style="z-index: 999 !important;"
								message="#{msgs['tlos.ask.delete.confirm']}" appendToBody="true"
								header="#{msgs['tlos.ask.delete.cHeader']}" severity="alert"
								widgetVar="confirmation">
								<p:commandButton id="confirm" immediate="true" process="@this"
									value="#{msgs['tlos.ask.delete.confirm1']}"
									onclick="confirmation.hide()"
									actionListener="#{agentPanelMBean['deleteInputParamAction']}" />
								<p:commandButton id="decline"
									value="#{msgs['tlos.ask.delete.confirm2']}"
									onclick="confirmation.hide()" type="button" />
							</p:confirmDialog>

						</p:column>

						<p:column
							headerText="#{msgs['tlos.workspace.pannel.job.parameterName']}"
							sortBy="#{item.name}">
							<h:outputText value="#{item.name}" style="text-align: center;" />
						</p:column>

						<p:column
							headerText="#{msgs['tlos.workspace.pannel.job.parameterDesc']}"
							sortBy="#{item.desc}">
							<h:outputText value="#{item.desc}" style="text-align: center;" />
						</p:column>

						<p:column
							headerText="#{msgs['tlos.workspace.pannel.job.parameterPreValue']}"
							sortBy="#{item.preValue.stringValue}">
							<h:outputText value="#{item.preValue.stringValue}"
								style="text-align: center;" />
						</p:column>

						<p:column
							headerText="#{msgs['tlos.workspace.pannel.job.parameterType']}">
							<h:outputText value="#{msgs['tlos.combo.integer']}"
								style="text-align: center;"
								rendered="#{item.preValue.type eq 1}" />
							<h:outputText value="#{msgs['tlos.combo.string']}"
								style="text-align: center;"
								rendered="#{item.preValue.type eq 2}" />
							<h:outputText value="#{msgs['tlos.combo.date']}"
								style="text-align: center;"
								rendered="#{item.preValue.type eq 3}" />
							<h:outputText value="#{msgs['tlos.combo.time']}"
								style="text-align: center;"
								rendered="#{item.preValue.type eq 4}" />
							<h:outputText value="#{msgs['tlos.combo.dateTime']}"
								style="text-align: center;"
								rendered="#{item.preValue.type eq 5}" />
							<h:outputText value="#{msgs['tlos.combo.xPath']}"
								style="text-align: center;"
								rendered="#{item.preValue.type eq 6}" />
						</p:column>

					</p:dataTable>
				</p:panel>

				<br></br>

				<div class="tablectrl">
					<p:panel>
						<p:commandButton id="agentInsertButton"
							value=" #{msgs['tlos.button.save']} "
							rendered="#{agentPanelMBean.insertButton and security.AgentSave}"
							actionListener="#{agentPanelMBean.insertAgentAction}">
							<f:param name="iCheck" value="insert" />
						</p:commandButton>

						<p:commandButton id="agentUpdateButton"
							value="#{msgs['tlos.button.update']}"
							rendered="#{not agentPanelMBean.insertButton and security.AgentUpdate}"
							actionListener="#{agentPanelMBean.updateAgentAction}" />

						<p:commandButton value="#{msgs['tlos.button.back']}" ajax="false"
							immediate="true" rendered="#{security.AgentBack}"
							action="agentSearchPanel.xhtml">
						</p:commandButton>
					</p:panel>
				</div>
			</p:fieldset>
		</h:form>
	</ui:define>
</ui:composition>

